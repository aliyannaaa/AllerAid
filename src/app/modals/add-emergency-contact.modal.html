<ion-header>
  <ion-toolbar>
    <ion-title>{{ isEditMode ? 'Edit' : 'Add' }} Emergency Contact</ion-title>
    <ion-buttons slot="start">
      <ion-button (click)="cancel()" fill="clear">
        <ion-icon name="arrow-back-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-buttons slot="end">
      <ion-button (click)="saveContact()" [disabled]="!contactData.name.trim() || !contactData.phoneNumber.trim()">
        <ion-icon name="checkmark-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <!-- Contact Name -->
  <ion-item>
    <ion-label position="stacked">Full Name *</ion-label>
    <ion-input 
      [(ngModel)]="contactData.name"
      placeholder="Enter full name"
      required>
    </ion-input>
  </ion-item>

  <!-- Phone Number -->
  <ion-item>
    <ion-label position="stacked">Phone Number *</ion-label>
    <ion-input 
      [(ngModel)]="contactData.phoneNumber"
      (ionInput)="formatPhoneNumber($event)"
      placeholder="(123) 456-7890"
      type="tel"
      maxlength="14"
      required>
    </ion-input>
  </ion-item>

  <!-- Quick Relationship Selection -->
  <div style="margin: 24px 0 16px 0;">
    <ion-label style="font-weight: 600; color: #0a3977; margin-bottom: 12px; display: block;">
      Relationship:
    </ion-label>
    <div class="relationship-chips">
      <ion-chip 
        *ngFor="let relationship of relationshipOptions" 
        (click)="selectRelationship(relationship)"
        [outline]="contactData.relationship !== relationship"
        [fill]="contactData.relationship === relationship ? 'solid' : 'outline'"
        style="margin: 4px;">
        {{ relationship }}
      </ion-chip>
    </div>
  </div>

  <!-- Custom Relationship -->
  <ion-item *ngIf="!relationshipOptions.includes(contactData.relationship)">
    <ion-label position="stacked">Custom Relationship</ion-label>
    <ion-input 
      [(ngModel)]="contactData.relationship"
      placeholder="Specify relationship">
    </ion-input>
  </ion-item>

  <!-- Email (Optional) -->
  <ion-item>
    <ion-label position="stacked">Email (Optional)</ion-label>
    <ion-input 
      [(ngModel)]="contactData.email"
      placeholder="email@example.com"
      type="email">
    </ion-input>
  </ion-item>

  <!-- Address (Optional) -->
  <ion-item>
    <ion-label position="stacked">Address (Optional)</ion-label>
    <ion-textarea 
      [(ngModel)]="contactData.address"
      placeholder="Full address..."
      rows="3"
      autoGrow="true">
    </ion-textarea>
  </ion-item>

  <!-- Primary Contact Toggle -->
  <ion-item>
    <ion-checkbox [(ngModel)]="contactData.isPrimary" slot="start"></ion-checkbox>
    <ion-label style="margin-left: 16px;">
      <h3>Primary Emergency Contact</h3>
      <p style="color: #666; margin: 0;">This person will be contacted first in case of emergency</p>
    </ion-label>
  </ion-item>

  <!-- Contact Information Tips -->
  <div style="margin-top: 24px; padding: 16px; background-color: #e8f4fd; border-radius: 8px;">
    <h4 style="margin: 0 0 8px 0; color: #0a3977;">
      <ion-icon name="information-circle-outline" style="margin-right: 8px;"></ion-icon>
      Emergency Contact Tips
    </h4>
    <ul style="margin: 0; padding-left: 20px; font-size: 14px; color: #666;">
      <li>Choose someone who is typically available and can respond quickly</li>
      <li>Consider selecting contacts in different locations (home, work)</li>
      <li>Make sure your contacts know about your medical conditions and allergies</li>
      <li>Update contact information regularly</li>
    </ul>
  </div>

  <!-- Action Buttons -->
  <div style="margin-top: 32px;">
    <ion-button 
      expand="block" 
      (click)="saveContact()" 
      [disabled]="!contactData.name.trim() || !contactData.phoneNumber.trim() || !contactData.relationship.trim()">
      <ion-icon name="save-outline" slot="start"></ion-icon>
      {{ isEditMode ? 'Update' : 'Add' }} Emergency Contact
    </ion-button>

    <ion-button 
      *ngIf="isEditMode" 
      expand="block" 
      color="danger" 
      fill="outline" 
      (click)="deleteContact()"
      style="margin-top: 12px;">
      <ion-icon name="trash-outline" slot="start"></ion-icon>
      Delete Emergency Contact
    </ion-button>
  </div>
</ion-content>
